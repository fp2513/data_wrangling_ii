---
title: "101024 reading_data_from_web"
output: github_document
date: "2024-10-10"
---

```{r setup, include=FALSE}
library(tidyverse)
library(rvest)
library(httr)

knitr::opts_chunk$set(
  fig.width = 6,
  fig.asp = .6,
  out.width = "90%"
)

theme_set(theme_minimal() + theme(legend.position = "bottom"))

options(
  ggplot2.continuous.colour = "viridis",
  ggplot2.continuous.fill = "viridis"
)

scale_colour_discrete = scale_colour_viridis_d
scale_fill_discrete = scale_fill_viridis_d
```

Scraping data ( copy and paste data can be a pain)l rvest package
Selector gadget; clicking around in a webpage and it will highlight
rvest pacakage (download the html, then extract all the elements of the html with the selector CSS selector)
Rather than scraping, API (a way to request specific data from server)

```{r}
url = "https://samhda.s3-us-gov-west-1.amazonaws.com/s3fs-public/field-uploads/2k15StateFiles/NSDUHsaeShortTermCHG2015.htm"

drug_use_html = read_html(url)
```

Read the html and now i need to get the data that i actually need from it 
Get the pieces that i actually need

```{r}
drug_use_html %>% 
  html_table()
```

I want to extract a table that the html already has, html_table can identify the table, finds all 15 tables on the page 

To take the first element out of the table 

```{r}
marj_use_df = 
drug_use_html %>% 
  html_table() %>% 
  first()
```

